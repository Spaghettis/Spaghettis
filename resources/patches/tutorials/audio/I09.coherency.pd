#N canvas 461 153 410 389 12;
#X obj 36 300 output;
#N canvas 316 127 904 154 more 0;
#X text 12 12 Simple coherence test to distinguish between sinusoids and noise in an input signal.;
#X f 85;
#X text 12 36 Here we just test that neighboring channels are pi radians out of phase (as they should be).;
#X f 93;
#X text 12 60 If any three channels are so arranged \, all three are considered as contributing to a sinusoid.;
#X f 94;
#X text 12 84 The "incoherence" measure corresponds to zero if the phase relationship is perfect and larger otherwise.;
#X f 105;
#X text 12 108 A threshold may be adjusted to filter the noise in the signal.;
#X f 63;
#X coords 0 0 1 1 250 175 0 0 0;
#X restore 156 240 pd more;
#X obj 12 12 cnv 15 275 45 empty empty empty 0 -7 0 10 #cccccc #000000;
#X obj -60 12 freeze;
#X text 24 24 coherency;
#X text 12 72 Pitched / unpitched separation.;
#N canvas 518 208 753 316 hann 0;
#X obj 36 264 tabwrite \$0-hann;
#X obj 36 24 loadbang;
#X obj 36 132 t f f;
#N canvas 0 22 500 350 \$0-hann 0;
#X array \$0-hann 1024 float 2;
#X coords 0 1 1024 0 250 175 1 0 0;
#X restore 468 72 graph \$0-hann;
#X obj 36 60 bng 15 250 50 0 empty empty empty 17 7 0 10 #ffffff #000000 #000000;
#X obj 36 96 uzi 1024;
#X obj 144 192 expr (-cos(($f1/512)*pi)/2)+0.5;
#X connect 1 0 4 0;
#X connect 2 0 6 0;
#X connect 2 1 0 1;
#X connect 4 0 5 0;
#X connect 5 2 2 0;
#X connect 6 0 0 0;
#X coords 0 0 1 1 250 175 0 0 0;
#X restore 156 264 pd hann;
#N canvas 494 53 497 717 fft 0;
#X obj 120 516 *~;
#X obj 36 624 *~;
#X obj 36 96 *~;
#X obj 36 24 inlet~;
#X obj 36 132 rfft~;
#X f 10;
#X obj 36 552 rifft~;
#X obj 36 660 outlet~;
#X obj 36 516 *~;
#X obj 72 60 tabreceive~ \$0-hann;
#X obj 72 588 tabreceive~ \$0-hann;
#X obj 156 288 *~ -1;
#X obj 156 324 +~ 1;
#X obj 300 408 lrshift~ -1;
#X obj 300 372 sig~ 1;
#X obj 156 468 *~;
#X obj 300 660 block~ 1024 4;
#X obj 156 372 /~ 1024;
#X obj 300 24 inlet;
#N canvas 258 113 464 526 incoherence 0;
#X obj 84 336 *~;
#X obj 240 132 *~;
#X obj 36 132 *~;
#X obj 120 192 lrshift~ 1;
#X obj 324 192 lrshift~ 1;
#X obj 120 228 lrshift~ -1;
#X obj 324 228 lrshift~ -1;
#X obj 288 336 *~;
#X obj 36 420 +~;
#X obj 240 336 *~;
#X obj 36 336 *~;
#X obj 36 288 +~;
#X obj 84 288 +~;
#X obj 240 288 +~;
#X obj 288 288 +~;
#X obj 132 72 rmag~;
#X obj 36 24 inlet~;
#X obj 240 24 inlet~;
#X obj 36 468 outlet~;
#X connect 0 0 8 0;
#X connect 1 0 4 0;
#X connect 1 0 6 0;
#X connect 1 0 13 0;
#X connect 1 0 14 0;
#X connect 2 0 3 0;
#X connect 2 0 5 0;
#X connect 2 0 11 0;
#X connect 2 0 12 0;
#X connect 3 0 11 1;
#X connect 4 0 13 1;
#X connect 5 0 12 1;
#X connect 6 0 14 1;
#X connect 7 0 8 1;
#X connect 8 0 18 0;
#X connect 9 0 8 1;
#X connect 10 0 8 0;
#X connect 11 0 10 0;
#X connect 11 0 10 1;
#X connect 12 0 0 0;
#X connect 12 0 0 1;
#X connect 13 0 9 0;
#X connect 13 0 9 1;
#X connect 14 0 7 0;
#X connect 14 0 7 1;
#X connect 15 0 1 1;
#X connect 15 0 2 1;
#X connect 16 0 15 0;
#X connect 16 0 2 0;
#X connect 17 0 15 1;
#X connect 17 0 1 0;
#X coords 0 0 1 1 250 175 0 0 0;
#X restore 156 216 pd incoherence;
#N canvas 458 74 260 379 threshold 0;
#X obj 36 216 *~;
#X obj 108 156 lrshift~ 1;
#X obj 108 216 lrshift~ -1;
#X obj 36 276 *~;
#X obj 36 24 inlet~;
#X obj 36 324 outlet~;
#X obj 108 24 inlet;
#X obj 36 108 >~;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 3 1;
#X connect 3 0 5 0;
#X connect 4 0 7 0;
#X connect 6 0 7 1;
#X connect 7 0 1 0;
#X connect 7 0 0 0;
#X connect 7 0 2 0;
#X coords 0 0 1 1 250 175 0 0 0;
#X restore 156 252 pd threshold;
#X obj 300 216 expr $f1*$f1/1250;
#X text 300 444 Zeros the DC bin.;
#X connect 0 0 5 1;
#X connect 1 0 6 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 7 0;
#X connect 4 0 18 0;
#X connect 4 1 0 0;
#X connect 4 1 18 1;
#X connect 5 0 1 0;
#X connect 7 0 5 0;
#X connect 8 0 2 1;
#X connect 9 0 1 1;
#X connect 10 0 11 0;
#X connect 11 0 16 0;
#X connect 12 0 14 1;
#X connect 13 0 12 0;
#X connect 14 0 7 1;
#X connect 14 0 0 1;
#X connect 16 0 14 0;
#X connect 17 0 20 0;
#X connect 18 0 19 0;
#X connect 19 0 10 0;
#X connect 20 0 19 1;
#X coords 0 0 1 1 250 175 0 0 0;
#X restore 36 264 pd fft;
#N canvas 689 87 433 512 signal 0;
#X obj 36 312 *~;
#X obj 36 36 noise~;
#X obj 36 456 outlet~;
#X obj 36 420 hip~ 5;
#X obj 36 72 bp~ 10000 3;
#X obj 120 312 *~;
#X obj 120 108 osc~ 440;
#X obj 240 108 dbtoamp;
#X obj 324 108 dbtoamp;
#X msg 240 144 \$1 30;
#X msg 324 144 \$1 30;
#X obj 240 180 line~;
#X obj 324 180 line~;
#X obj 240 36 nbx 5 40 0 100 0 1 empty empty empty 0 -7 0 10 #ffffff #000000 #000000 85 100;
#X obj 324 36 nbx 5 40 0 100 0 1 empty empty empty 0 -7 0 10 #ffffff #000000 #000000 90 100;
#X connect 0 0 3 0;
#X connect 1 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 3 0;
#X connect 6 0 5 0;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 12 0;
#X connect 11 0 0 1;
#X connect 12 0 5 1;
#X connect 13 0 7 0;
#X connect 14 0 8 0;
#X coords 0 0 1 1 250 175 0 0 0;
#X restore 36 108 pd signal;
#X obj 156 108 nbx 5 40 0 100 0 1 empty empty empty 0 -7 0 10 #ffffff #000000 #000000 100 100;
#X floatatom 156 168 5 0 100 1 - - -;
#X f 5;
#X connect 7 0 0 0;
#X connect 8 0 7 0;
#X connect 9 0 10 0;
#X connect 10 0 7 1;
#X coords 0 0 1 1 250 175 0 0 0;
