
/* < https://opensource.org/licenses/BSD-3-Clause > */

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

#define TEST_BENCHMARK_LOOP     1000000

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

#if 0
void test60__cosine() {
#endif

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

static volatile double benchmark_dummy;

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

TTT_BEGIN (BenchmarkCosine, 60, "Benchmark - Cosine")

    int i;
    
    t_rand48 seed; PD_RAND48_INIT (seed);

    cos_tilde_initialize();
    
    /* Claude Heiland-Allen's polynomial approximation. */
    
    PD_MEMORY_BARRIER; benchmark_dummy = 0; ttt_timeTrigger();
    
        for (i = 0; i < TEST_BENCHMARK_LOOP; i++) {
        //
        benchmark_dummy += cosf9 (PD_RAND48_DOUBLE (seed) * PD_TWO_PI);
        //
        }
    
    ttt_stdout (TTT_COLOR_BLUE, "COS: %f", ttt_timeTrigger());
    
    /* Miller Puckette's LUT. */
    
    PD_MEMORY_BARRIER; benchmark_dummy = 0; ttt_timeTrigger();
    
        for (i = 0; i < TEST_BENCHMARK_LOOP; i++) {
        //
        benchmark_dummy += dsp_getCosineAtLUT (PD_RAND48_DOUBLE (seed) * COSINE_TABLE_SIZE);
        //
        }
    
    ttt_stdout (TTT_COLOR_BLUE, "LUT: %f", ttt_timeTrigger());
    
    /* Standard function. */
    
    PD_MEMORY_BARRIER; benchmark_dummy = 0; ttt_timeTrigger();
    
        for (i = 0; i < TEST_BENCHMARK_LOOP; i++) {
        //
        benchmark_dummy += cos (PD_RAND48_DOUBLE (seed) * PD_TWO_PI);
        //
        }
    
    ttt_stdout (TTT_COLOR_BLUE, "STD: %f", ttt_timeTrigger());
    
    cos_tilde_release();

TTT_END

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

#if 0
}
#endif

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
// MARK: -

#if 0
void test61__sqrt() {
#endif

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

TTT_BEGIN (BenchmarkSqrt, 61, "Benchmark - Sqrt")

rsqrt_tilde_initialize();

TTT_END

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------

#if 0
}
#endif

// -----------------------------------------------------------------------------------------------------------
// -----------------------------------------------------------------------------------------------------------
